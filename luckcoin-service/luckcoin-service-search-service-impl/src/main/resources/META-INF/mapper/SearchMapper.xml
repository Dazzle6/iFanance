<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
      "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.kidjoker.search.dao.SearchDao">

    <resultMap id="SearchMap" type="cn.kidjoker.search.model.SearchPO">
        <id column="id" property="id" javaType="long" />
        <result column="variable1" property="variable1" javaType="string" />
        <result column="variable2" property="variable2" javaType="string" />
        <result column="variable3" property="variable3" javaType="string" />
        <result column="createTime" property="createTime" javaType="Date" />
        <result column="updateTime" property="updateTime" javaType="Date" />
    </resultMap>

    <sql id="selectColumns">
        A.id, A.variable1, A.variable2, A.variable3, A.createTime, A.updateTime
    </sql>

    <sql id="selectWhere">
        <where>
            <if test="variable1 != null and variable1 != ''">
                AND A.variable1 = #{variable1, jdbcType=VARCHAR}
            </if>
        </where>
    </sql>
    
    <sql id="pageLimit">
        <if test="start !=null and limit != null">
            LIMIT #{start},#{limit}
        </if>
    </sql>
    
    <select id="selectList" resultMap="SearchMap"
        parameterType="HashMap">
        SELECT
        <include refid="selectColumns" />
        FROM Search A
        <include refid="selectWhere" />
        <include refid="pageLimit" />
    </select>
    
    <select id="selectCount" resultType="Integer" parameterType="HashMap">
        SELECT COUNT(A.id) FROM Search A
        <include refid="selectWhere" />
    </select>

    <select id="selectOne" resultMap="SearchMap" parameterType="HashMap">
        SELECT
        <include refid="selectColumns" />
        FROM Search A
        <include refid="selectWhere" />
    </select>
    
    <select id="selectById"  resultMap="SearchMap" parameterType="string">
        SELECT
        <include refid="selectColumns" />
        FROM Search A
        WHERE A.id = #{id,javaType=Long}
    </select>

    <insert id="insert" parameterType="cn.kidjoker.search.model.SearchPO">
    <![CDATA[
        INSERT INTO Search
        ( 
	        variable1,
	        variable2,
	        variable3,
	        createTime
        )
        VALUES(
            #{variable1,jdbcType=VARCHAR},
            #{variable2,jdbcType=VARCHAR},
            #{variable3,jdbcType=VARCHAR},
            CURRENT_TIMESTAMP
        )
    ]]>
    </insert>
  
</mapper>